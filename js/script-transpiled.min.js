"use strict";function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}window.filterWhitelist=["year","ps","width","volume","capacity","price"];window.whitelistedIndices=["usedmachines","classifieds","usedmachines,classifieds"];window.initializeCategoryDOMTree=false;window.redirected=false;window.mobileBreakpoint=992;var client=new $.es.Client({host:"https://search2.landwirt.com/"});URI.escapeQuerySpace=false;var uri=new URI;var defaultDiacriticsRemovalMap=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}];var defaultDiacriticsRemovalMapLength=defaultDiacriticsRemovalMap.length;var domain="https://www.landwirt.com/";var imageUrlBasePath="https://static.landwirt.com/";var eZImageUrlBasePath="https://bilder.landwirt.com/";var youtubePreviewUrl="https://img.youtube.com/vi/";var youtubeQuality="mq";var classifiedBaseUrl="https://www.landwirt.com/ez/index.php/kleinanzeigen/anfrage/";var articleImageUrlBasePath="https://bilder.landwirt.com/ez/ezimagecatalogue/catalogue/variations/";var goldBadgeUrl="https://www.landwirt.com/assets/img/gmm/premium_3.png";var articleImageSize="150x150";var faqImageUrlBasePath="https://static.landwirt.com/fachfragen/";var pageLimit=30;var searchResultTemplate=function searchResultTemplate(_ref){var type=_ref.type,id=_ref.id,created=_ref.created,title=_ref.title,subtitle=_ref.subtitle,description=_ref.description,imageUrl=_ref.imageUrl,url=_ref.url,price=_ref.price,taxname=_ref.taxname,discount_rate=_ref.discount_rate,firm_premium_factor=_ref.firm_premium_factor,firmid=_ref.firmid,hasdiscount=_ref.hasdiscount,state=_ref.state,dataQuality=_ref.dataQuality,properties=_ref.properties;var imageHtml="";var date=new Date(created*1e3);var datevalues={year:date.getFullYear(),month:(date.getMonth()+1).toString().length>1?date.getMonth()+1:"0"+(date.getMonth()+1).toString(),day:date.getDate().toString().length>1?date.getDate():"0"+date.getDate(),hour:date.getHours().toString().length>1?date.getHours():"0"+date.getHours(),minute:date.getMinutes().toString().length>1?date.getMinutes():"0"+date.getMinutes(),second:date.getSeconds().toString().length>1?date.getSeconds():"0"+date.getSeconds()};var maxLength=110;var shortDesc=$.trim(description);var subheading=$.trim(subtitle);var subheadingHTMLElement="";if(shortDesc.length>maxLength){shortDesc=$.trim(description).substring(0,maxLength).split(" ").slice(0,-1).join(" ")+"..."}var typeLang="";var firm_rating="";var stars="";var vipBadge="";var ctopBadge="";taxname=taxname||"";discount_rate=parseInt(discount_rate,10);var topBadge="";var typeText="";var mobileBadges="";var goldBadge="";var goldClass="";var propertiesText="";var logo="";if(type==="classifieds"&&hasdiscount===1){vipBadge='<div class="gmmprice2sp topcolor cvip-bg">VIP</div>'}else if(type==="classifieds"&&hasdiscount===2){ctopBadge='<div class="gmmprice2sp topcolor ctop-bg">TOP</div>'}else if(type==="classifieds"&&hasdiscount===3){vipBadge='<div class="gmmprice2sp topcolor cvip-bg">VIP</div>';ctopBadge='<div class="gmmprice2sp topcolor ctop-bg">TOP</div>'}if(discount_rate>0){price=price*(100-discount_rate)/100}if(price===0){price="auf Anfrage"}else{price=price.toFixed(2);var decimalPlaces=price.toString().split(".")[1];price=price.toString().split(".")[0].split("").reverse();var _i,j,temparray,chunk=3;var formattedPrice=[];for(_i=0,j=price.length;_i<j;_i+=chunk){temparray=price.slice(_i,_i+chunk);formattedPrice.push(temparray.reverse().join(""))}price=formattedPrice.reverse().join(".");price="EUR "+price;if(typeof decimalPlaces!=="undefined"&&type==="classifieds"&&decimalPlaces!="00"){price=price+","+decimalPlaces}}if(firm_premium_factor===1){firm_rating=""}else if(firm_premium_factor===2){firm_rating=""}else if(firm_premium_factor===3){firm_rating="";goldBadge='<img src="'.concat(goldBadgeUrl,'" class="gold-badge" />');if(firmid){logo="<img class='img-responsive search-result-logo' src='".concat(imageUrlBasePath).concat(firmid,"/logo.jpg?v=3' />")}}if(false){for(var i=0;i<Math.round(firm_premium_factor);i++){stars+='<i class="fa fa-star event-start" style="min-width: 15px; color: #008a4c;"></i>'}firm_rating='\n      <div class="col-xs-12 col-sm-12" style="margin:5px 0 10px 0;font-weight:bold;padding:0px!important">\n        Händlerbewertung <span class="rev-rating-c">'.concat(firm_premium_factor,"</span> ").concat(stars,"\n      </div>\n    ")}if(discount_rate===0){topBadge='<div class="gmmprice2sp topcolor">TOP</div>'}else if(discount_rate>0){topBadge='<div class="gmmprice2sp">-'.concat(discount_rate,"%</div>")}if(state===null){state=""}if(imageUrl.indexOf("null")!==-1){imageUrl="/assets/img/LandwirtTractor.png"}if(document.body.clientWidth<=window.mobileBreakpoint){imageHtml="<a href=".concat(url,'>\n    <div class="col-sm-4 col-xs-12 search-result-img" style="background-image: url(').concat(imageUrl,'); background-position: center; background-size: cover; padding: 0;"></div>\n    </a>')}else{imageHtml='<div class="col-sm-4 col-xs-12 search-result-img" style="padding: 0;">\n      <a href='.concat(url,">\n        <img src=").concat(imageUrl,' onError="setErrorImage(this);" class="img-responsive gmmtrefferListImg" />\n      </a>\n    </div>')}if(type==="usedmachines"){typeLang="Gebrauchtmaschinen";typeText="G";mobileBadges='<div class="mobile-badge-container">'.concat(topBadge,'</div><div class="clearfix"></div>')}else if(type==="classifieds"){typeLang="Kleinanzeigen";typeText="K";mobileBadges='<div class="mobile-badge-container">'.concat(ctopBadge,'</div><div class="mobile-badge-container">').concat(vipBadge,'</div><div class="clearfix"></div>')}if(properties["year"]){propertiesText=propertiesText+"<div class='gmmlistcatfield'><strong>Baujahr:</strong> ".concat(properties.year,"</div>")}if(properties["hours"]){propertiesText=propertiesText+"<div class='gmmlistcatfield'><strong>Betriebsstunden:</strong> ".concat(properties.hours,"</div>")}if(properties["ps"]){propertiesText=propertiesText+"<div class='gmmlistcatfield'><strong>PS:</strong> ".concat(properties.ps,"</div>")}if(properties["capacity"]){propertiesText=propertiesText+"<div class='gmmlistcatfield'><strong>Kapazität</strong> ".concat(properties.capacity,"</div>")}if(properties["volume"]){propertiesText=propertiesText+"<div class='gmmlistcatfield'><strong>Volumen:</strong> ".concat(properties.volume,"</div>")}if(properties["width"]){propertiesText=propertiesText+"<div class='gmmlistcatfield'><strong>Breite:</strong> ".concat(properties.width,"</div>")}if(propertiesText!==""){propertiesText=propertiesText+"<div class='clearfix' style='margin-bottom: 10px;'></div>"}return'\n  <div class="gmmtreffer '.concat(goldClass,'">\n    <div class="gmmtrefferinnen">\n        ').concat(imageHtml,'\n\n        <div class="gmmtreffertext col-sm-6 col-xs-12">\n          <div class="" data-badge="').concat(typeLang,'">\n            <h4 class="col-xs-6 col-sm-12" style="padding: 0;"><a href=').concat(url,">").concat(title,'</a><div class="clearfix"></div></h4>\n            <strong style="position: relative; top: -4px; margin-bottom: 3px;">').concat(subheading,'</strong>\n            <div class="mobile-badges col-xs-6 col-sm-12" style="text-align: right;">\n              ').concat(mobileBadges,'\n            </div>\n          </div>\n\n          <div class="search-result"><div class="firm-rating">').concat(firm_rating,"</div>").concat(shortDesc,"</div>\n          <div style='margin-top: 5px;'>").concat(propertiesText,'</div>\n\n          <div class="col-xs-8 visible-xs" style="padding: 0;">\n            <div class="pull-left" style="height: 75px;">').concat(goldBadge,'</div>\n            <div class="pull-left" style="height: 75px;">').concat(logo,'</div>\n            <div class="clearfix"></div>\n          </div>\n\n          <div class="col-xs-4 col-sm-12 pull-right">\n            <div class="mobile-price text-right pricetagbig show-xs text-left">').concat(price,'</div>\n            <div class="gmmVat text-right">').concat(taxname,'</div>\n            <div class="details-row"></div>\n            <div class="state-container">\n              <p class="state-detail">').concat(state,'</p>\n            </div>\n            <div class="text-right col-xs-6 date-container">\n              <p class="date-detail"></p>\n            </div>\n          </div>\n        </div>\n\n        <div class="col-sm-2" style="text-align: center; padding: 0; max-width: 120px; float: right;">\n          <div class="hidden-xs">\n            ').concat(topBadge).concat(ctopBadge).concat(vipBadge,"\n            ").concat(goldBadge,"\n            ").concat(logo,'\n          </div>\n\n          <div class="clearfix visible-lg"></div>\n        </div>\n    </div>\n  </div>')};function setAd(){console.log("set ad!!");console.log(googletag);googletag.cmd.push(function(){googletag.defineSlot("/4095575/Listing_Native_oben",["fluid"],"div-gpt-ad-1556087714177-0").addService(googletag.pubads()).setCollapseEmptyDiv(true,true);googletag.pubads().setTargeting("Suchstring",window.currentState.q);googletag.pubads().enableSingleRequest();googletag.enableServices()})}function displayAd(){googletag.cmd.push(function(){googletag.display("div-gpt-ad-1556087714177-0")})}function makeUrl(url){var cleanUrl="";if(url!==null){cleanUrl=url.replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss").replace(/Ä/g,"Ae").replace(/Ö/g,"Oe").replace(/Ü/g,"Ue").replace(/ /g,"-");for(var i=0;i<defaultDiacriticsRemovalMapLength;i+=1){cleanUrl=cleanUrl.replace(defaultDiacriticsRemovalMap[i].letters,defaultDiacriticsRemovalMap[i].base)}cleanUrl=cleanUrl.replace(/[^a-zA-Z0-9-_]+/g,"")}return cleanUrl}function resetCategoryFilters(filters){$("#loadingIconContainer").show();if(typeof filters.maincategory==="undefined"){delete filters.maincategory;removeSingleParamFromUrl("maincategory")}if(typeof filters.subcategory==="undefined"){delete filters.subcategory;removeSingleParamFromUrl("subcategory")}return filters}function filterWrapper(event){var searchIndex=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"usedmachines";var level=arguments.length>2?arguments[2]:undefined;event.preventDefault();var target=$(event.target);var currentText=target.text();if(target.is("a")){}else{target=target.parent("a");currentText=target.text()}var filters={};if(level==="maincategory"){filters[level]=currentText.replace(/ \(\d+\)/,"")}else if(level==="subcategory"){var parentCategory=target.parent().parent().siblings("a").text();filters["maincategory"]=parentCategory.replace(/ \(\d+\)/,"");filters[level]=currentText.replace(/ \(\d+\)/,"")}else if(level==="brand"){var parentSubCategory=target.parent().parent().siblings("a");var parentSubCategoryText=parentSubCategory.text();var parentMainCategory=parentSubCategory.parent().parent().siblings("a");var parentMainCategoryText=parentMainCategory.text();filters["maincategory"]=parentMainCategoryText.replace(/ \(\d+\)/,"");filters["subcategory"]=parentSubCategoryText.replace(/ \(\d+\)/,"");filters[level]=currentText.replace(/ \(\d+\)/,"")}$(".searchResults").html("");$(".customSort").css({display:"none"});target.parent().siblings().children("ul").addClass("hidden");target.css({textDecoration:"underline",fontWeight:"bold"});target.parent().siblings().children("a").css({textDecoration:"none",fontWeight:"normal"});filters=resetCategoryFilters(filters);removeSingleParamFromUrl("page");if(typeof filters.maincategory!=="undefined"){addSingleParamToUrl("maincategory",filters.maincategory)}if(typeof filters.subcategory!=="undefined"){addSingleParamToUrl("subcategory",filters.subcategory)}doSearch(event,searchIndex)}function buildFiltersFromUrl(){var filters={};if(window.currentState.maincategory){filters.maincategory=window.currentState.maincategory.replace(/ \(\d+\)/,"")}if(window.currentState.subcategory){filters.subcategory=window.currentState.subcategory.replace(/ \(\d+\)/,"")}return filters}function openCategoryTreeIfClosed(){var subcategoryItem=false;var maincategoryItem=false;if(typeof window.currentState.maincategory==="undefined"){return false}var target;if(window.currentState.index==="usedmachines"){target=$(".usedMachinesListElement")}else if(window.currentState.index==="classifieds"){target=$(".classifiedsListElement")}else{return false}maincategoryItem=target.find(".nestedList").children("li").children("a").filter(function(){return $(this).text().replace(/ \(\d+\)/,"")===window.currentState.maincategory});subcategoryItem=maincategoryItem.parent().children("ul").children("li").children("a").filter(function(){return $(this).text().replace(/ \(\d+\)/,"")===window.currentState.subcategory});maincategoryItem.next("ul").removeClass("hidden");maincategoryItem.css({fontWeight:"bold",textDecoration:"underline"});subcategoryItem.parent().css({fontWeight:"bold",textDecoration:"underline"})}function buildCategoryDOMTree(classifications,categoryHits){var filters=buildFiltersFromUrl();var usedMachinesCount="";var classifiedsCount="";if(window.initializeCategoryDOMTree===false&&($(".classifiedsListElement").find(".nestedList")||$(".usedMachinesListElement").find(".nestedList"))&&filters!==false){return false}if(window.initializeCategoryDOMTree===true){$(".classifiedsListElement").find(".nestedList").remove();$(".usedMachinesListElement").find(".nestedList").remove()}if(classifications.length>0){for(var _i2=0;_i2<categoryHits.length;_i2+=1){if(categoryHits[_i2].key==="lawi-de-usedmachines"){usedMachinesCount="".concat(categoryHits[_i2].doc_count)}else if(categoryHits[_i2].key==="lawi-de-classifieds"){classifiedsCount="".concat(categoryHits[_i2].doc_count)}}$(".cat-count").remove();if(usedMachinesCount!==""){$("li.usedMachinesListElement a.usedmachines").append(' <span class="cat-count">('.concat(usedMachinesCount,")</span>"))}if(classifiedsCount!==""){$("li.classifiedsListElement a.classifieds").append(' <span class="cat-count">('.concat(classifiedsCount,")</span>"))}if(window.currentState.index==="usedmachines"){window.target=$(".usedMachinesListElement")}else if(window.currentState.index==="classifieds"){window.target=$(".classifiedsListElement")}else{return false}window.target.append("<ul class='nestedList'></ul>");var nestedList=$("#mobileSidenavContainer .nestedList, .sidenavContainer .nestedList");var i=0;var j=0;classifications.forEach(function(topCategory){nestedList.append("<li id='topCategory-"+i+"'><a href='#' onclick='filterWrapper(event, \""+window.currentState.index+'", "maincategory")\'>'+topCategory.key+" <span class='cat-count'>("+topCategory.doc_count+")</span>"+"</a></li>");var currentNode=$("#topCategory-"+i);if(topCategory.sub_categories.buckets.length>0){var subCategories=topCategory.sub_categories.buckets;currentNode.append("<ul id='subCategoryList-"+j+"' class='hidden'></ul>");var subCategoryList=$("#subCategoryList-"+j);currentNode.find("a").on("click",function(e){e.preventDefault();subCategoryList.removeClass("hidden")});subCategories.forEach(function(subCategory){subCategoryList.append("<li id='subCatItem-"+j+"' style='font-weight: normal;'><a href='#' onclick='filterWrapper(event, \""+window.currentState.index+'", "subcategory")\'>'+subCategory.key+"</a></li>");var subCatItem=$("#subCatItem-"+j);j++})}i++});openCategoryTreeIfClosed()}window.initializeCategoryDOMTree=false}function addBrandsToDOM(brands){if(brands.length>0){var brandsContainer=$(".brands-filter");var headingText="Marken";var index=1;$(".brands-heading-container").show();if(brands.length>10){$(".toggleBrandsLink").removeClass("hidden")}$(".brands-heading").text(headingText);brands.forEach(function(brand){if(index<=10){brandsContainer.append("<div><input type='checkbox' id='brand-checkbox-".concat(index,"' value='1' class='brand-item' data-filterbox='").concat(brand.key,"' /><label style='font-weight: 300;' for='brand-checkbox-").concat(index,"'>").concat(brand.key,"</label></div>"))}else{var queryString=URI(uri.toString());var hiddenClass=queryString.hasQuery("showAllBrands",1)===true?"":"hidden";brandsContainer.append("<div><input type='checkbox' value='1' id='brand-checkbox-".concat(index,"' class='brand-item toToggle ").concat(hiddenClass,"' data-filterbox='").concat(brand.key,"' /><label class='toToggle ").concat(hiddenClass,"' for='brand-checkbox-").concat(index,"' style='font-weight: 300;'>").concat(brand.key,"</label></div>"))}index++})}}function addFeaturesToDOM(features){if(features.length>0){var featuresContainer=$(".features-filter");var headingText="Besonderheiten";var index=1;$(".features-heading-container").show();if(features.length>10){$(".toggleFeaturesLink").removeClass("hidden")}$(".features-heading").text(headingText);features.forEach(function(feature){if(index<=10){featuresContainer.append("<div><input type='checkbox' id='feature-checkbox-".concat(index,"' value='1' class='feature-item' data-filterbox='").concat(feature.key,"' /><label style='font-weight: 300;' for='feature-checkbox-").concat(index,"'>").concat(feature.key,"</label></div>"))}else{var queryString=URI(uri.toString());var hiddenClass=queryString.hasQuery("showAllFeatures",1)===true?"":"hidden";featuresContainer.append("<div><input id='feature-checkbox-".concat(index,"' type='checkbox' value='1' class='feature-item toToggle ").concat(hiddenClass,"' data-filterbox='").concat(feature.key,"' /><label class='toToggle ").concat(hiddenClass,"' for='feature-checkbox-").concat(index,"' style='font-weight: 300;'>").concat(feature.key,"</label></div>"))}index++})}}function addPriceToDOM(){var currentHeadingText=$(".range-filter-heading").text();if(currentHeadingText===""){$(".range-filter-heading").text("Filter");$(".range-filter-heading-container").show()}}function addYearsToDOM(years){if(years.length>0){$(".yearsFilterContainer").show();var yearFromBox=$(".yearFrom");var yearToBox=$(".yearTo");var rawYears=[];var currentHeadingText=$(".range-filter-heading").text();if(currentHeadingText===""){$(".range-filter-heading").text("Filter");$(".range-filter-heading-container").show()}years.forEach(function(year){rawYears.push(year.key)});rawYears=rawYears.sort(function(a,b){return a-b}).reverse();rawYears.forEach(function(year){yearFromBox.append("<option value='".concat(year,"'>").concat(year,"</option>"));yearToBox.append("<option value='".concat(year,"'>").concat(year,"</option>"))})}else{$(".yearsFilterContainer").hide()}}function addHorsePowersToDOM(horsePowers){if(horsePowers.length>0){$(".hpFilterContainer").show();var hpFromBox=$(".psFrom");var hpToBox=$(".psTo");var rawHorsePowers=[];var currentHeadingText=$(".range-filter-heading").text();if(currentHeadingText===""){$(".range-filter-heading").text("Filter");$(".range-filter-heading-container").show()}horsePowers.forEach(function(hp){rawHorsePowers.push(hp.key)});rawHorsePowers=rawHorsePowers.sort(function(a,b){return a-b});rawHorsePowers.forEach(function(hp){hpFromBox.append("<option value='".concat(hp,"'>").concat(hp," PS</option>"));hpToBox.append("<option value='".concat(hp,"'>").concat(hp," PS</option>"))})}else{$(".hpFilterContainer").hide()}}function addWidthsToDOM(widths){if(widths.length>0){$(".widthsFilterContainer").show();var widthFromBox=$(".widthFrom");var widthToBox=$(".widthTo");var rawWidths=[];var currentHeadingText=$(".range-filter-heading").text();if(currentHeadingText===""){$(".range-filter-heading").text("Filter");$(".range-filter-heading-container").show()}widths.forEach(function(width){rawWidths.push(width.key)});rawWidths=rawWidths.sort(function(a,b){return a-b});rawWidths.forEach(function(width){widthFromBox.append("<option value='".concat(width,"'>").concat(width," cm</option>"));widthToBox.append("<option value='".concat(width,"'>").concat(width," cm</option>"))})}else{$(".widthsFilterContainer").hide()}}function addVolumesToDOM(volumes){if(volumes.length>0){$(".volumesFilterContainer").show();var volumeFromBox=$(".volumeFrom");var volumeToBox=$(".volumeTo");var rawVolumes=[];var currentHeadingText=$(".range-filter-heading").text();if(currentHeadingText===""){$(".range-filter-heading").text("Filter");$(".range-filter-heading-container").show()}volumes.forEach(function(volume){rawVolumes.push(volume.key)});rawVolumes=rawVolumes.sort(function(a,b){return a-b});rawVolumes.forEach(function(volume){volumeFromBox.append("<option value='".concat(volume,"'>").concat(volume," m&sup3;</option>"));volumeToBox.append("<option value='".concat(volume,"'>").concat(volume," m&sup3;</option>"))})}else{$(".volumesFilterContainer").hide()}}function addCapacitiesToDOM(capacities){if(capacities.length>0){$(".capacitiesFilterContainer").show();var capacityFromBox=$(".capacityFrom");var capacityToBox=$(".capacityTo");var rawCapacities=[];var currentHeadingText=$(".range-filter-heading").text();if(currentHeadingText===""){$(".range-filter-heading").text("Filter");$(".range-filter-heading-container").show()}capacities.forEach(function(capacity){rawCapacities.push(capacity.key)});rawCapacities=rawCapacities.sort(function(a,b){return a-b});rawCapacities.forEach(function(capacity){capacityFromBox.append("<option value='".concat(capacity,"'>").concat(capacity," l</option>"));capacityToBox.append("<option value='".concat(capacity,"'>").concat(capacity," l</option>"))})}else{$(".capacitiesFilterContainer").hide()}}function toggleDOMBrands(toggle){if(toggle==="show"){$(".toggleBrandsLink").text("weniger anzeigen...");$(".brands-filter input.toToggle, .brands-filter label.toToggle").removeClass("hidden")}else if(toggle==="hide"){$(".toggleBrandsLink").text("Alle anzeigen...");$(".brands-filter input.toToggle, .brands-filter label.toToggle").addClass("hidden")}}function toggleDOMFeatures(toggle){if(toggle==="show"){$(".toggleFeaturesLink").text("weniger anzeigen...");$(".features-filter input.toToggle, .features-filter label.toToggle").removeClass("hidden")}else if(toggle==="hide"){$(".toggleFeaturesLink").text("Alle anzeigen...");$(".features-filter input.toToggle, .features-filter label.toToggle").addClass("hidden")}}function toggleAllFeatures(e){e.preventDefault();var showAllFeatures="showAllFeatures";var queryString=URI(uri.toString());if(queryString.hasQuery(showAllFeatures,1)===true){removeSingleParamFromUrl(showAllFeatures);toggleDOMFeatures("hide")}else{addSingleParamToUrl(showAllFeatures,1);toggleDOMFeatures("show")}}function toggleAllBrands(e){e.preventDefault();var showAllBrands="showAllBrands";var queryString=URI(uri.toString());if(queryString.hasQuery(showAllBrands,1)===true){removeSingleParamFromUrl(showAllBrands);toggleDOMBrands("hide")}else{addSingleParamToUrl(showAllBrands,1);toggleDOMBrands("show")}}function addSingleParamToUrl(property,value){var currentUri=location.href.replace("&page=1","");var newUri=uri.setQuery(property,value).escapeQuerySpace(false);if(property!=="page"&&typeof newUri.search(true).page==="undefined"){newUri.setQuery("page",1)}if(currentUri.toString()===newUri.toString().replace("&page=1","")){return}var searchTerm=newUri.search(true).q;history.pushState({pageTitle:searchTerm,term:searchTerm},searchTerm,newUri);document.title=searchTerm+" | landwirt.com"}function removeSingleParamFromUrl(property){var currentUri=location.href.replace("&page=1","");var newUri=uri.removeQuery(property).escapeQuerySpace(false);var searchTerm=newUri.search(true).q;if(currentUri===newUri.toString().replace("&page=1","")){return}history.pushState({pageTitle:searchTerm,term:searchTerm},searchTerm,newUri);document.title=searchTerm+" | landwirt.com"}function addRangeParamsToUrl(rangeDetail,property,value){var queryString=URI.parse(uri.toString()).query;var params=URI.parseQuery(queryString);var newState="";if(params.hasOwnProperty(property)){var currentState=params[property];if(rangeDetail==="From"){newState=value+","+currentState.substring(currentState.indexOf(",")+1,currentState.length)}else if(rangeDetail==="To"){newState=currentState.substring(0,currentState.indexOf(","))+","+value}}else{if(rangeDetail==="From"){newState=value+","}else if(rangeDetail==="To"){newState=","+value}}addSingleParamToUrl(property,newState)}function addAggregationsToDOM(brands,features,classifications,years,horsePowers,widths,volumes,capacities,categoryHits){buildCategoryDOMTree(classifications,categoryHits);addBrandsToDOM(brands);addFeaturesToDOM(features);addPriceToDOM();addYearsToDOM(years);addHorsePowersToDOM(horsePowers);addWidthsToDOM(widths);addVolumesToDOM(volumes);addCapacitiesToDOM(capacities);$(".filter-button").removeClass("hidden")}function handleDidYouMean(suggest){var didYouMean="";var collateMatch=false;if(suggest){didYouMean=suggest.simple_phrase[0].options[0]?suggest.simple_phrase[0].options[0].highlighted:"";collateMatch=suggest.simple_phrase[0].options[0]?suggest.simple_phrase[0].options[0].collate_match:false}if(didYouMean!==""&&window.searchString.toLowerCase()!==didYouMean.toLowerCase()){$("#did-you-mean").html("Meinten Sie: "+"<a href='#' id='did-you-mean-link'>"+didYouMean+"</a>").css({display:"block"});$("#did-you-mean-link").on("click",function(event){event.preventDefault();var didMean=$(this).text();$("#searchInput").val(didMean);$("#search").submit()})}}function resetParams(searchTerm){uri.removeSearch(["page","brands","features","year","ps","width","volume","capacity","showAllFeatures","showAllBrands","maincategory","subcategory","index","price"]);history.pushState({pageTitle:searchTerm,term:searchTerm},searchTerm,uri);document.title=searchTerm+" | landwirt.com"}function initializeDOMForNewSearch(){var queryString=URI(uri.toString());$(".selectFiltersContainer select[class*=From]").html("<option selected value> von </option>");$(".selectFiltersContainer select[class*=To]").html("<option selected value> bis </option>");$(".resetFilter").hide();$("#did-you-mean").html("").css({display:"none"});$(".brands-filter").html("");$(".brands-heading").text("");$(".features-filter").html("");$(".features-heading").text("");$(".range-filter-heading").text("");$(".features-heading-container").hide();$(".brands-heading-container").hide();$(".filters-heading-container").hide();$(".range-filter-heading-container").hide();if(document.body.clientWidth>window.mobileBreakpoint){}if(queryString.hasQuery("showAllFeatures",1)===true){$(".toggleFeaturesLink").text("weniger anzeigen...")}if($("featuresFilter").length===0){$(".toggleFeaturesLink").addClass("hidden")}if(queryString.hasQuery("showAllBrands",1)===true){$(".toggleBrandsLink").text("weniger anzeigen...")}if($("brandsFilter").length===0){$(".toggleBrandsLink").addClass("hidden")}$(".searchResults").empty();$("#page-selection").addClass("hidden");$("#loadingIconContainer").removeClass("hidden")}function initializePagination(hits){$("#page-selection").empty();$("#page-selection").unbind("page");var pagination=$("#page-selection").bootpag({total:Math.ceil(hits/pageLimit),maxVisible:10,leaps:true,page:window.currentPage});pagination.on("page",function(e,page){e.preventDefault();window.initializeCategoryDOMTree=true;window.scrollTo(0,0);addSingleParamToUrl("page",page);window.initializeCategoryDOMTree=false;doSearch(e,window.currentState.index)})}function getCurrentStateFromUrl(){var queryString=URI.parse(uri.toString()).query;var params=URI.parseQuery(queryString);return params}function selectCheckboxFilter(dataValue){$(".filterForm input[data-filterbox='"+dataValue+"']").prop("checked",true)}function buildFilterArray(filters){var params=window.currentState;if(typeof window.currentState.maincategory==="undefined"){delete filters.maincategory}else if(typeof window.currentState.subcategory==="undefined"){delete filters.subcategory}var filterArrayFilters=[];if(filters){var classificationsFilter=[];Object.keys(filters).forEach(function(key){var newFilter={};newFilter["classifications.".concat(key,".keyword")]=filters[key];classificationsFilter.push({match:newFilter})});if(typeof window.classificationsFilter==="undefined"||window.classificationsFilter!==classificationsFilter){window.classificationsFilter=classificationsFilter}}else{window.classificationsFilter=[]}if(!filters&&typeof window.target!=="undefined"){$(".nestedList").remove()}var filterArrayClassifications=[{nested:{path:"classifications",query:{bool:{filter:window.classificationsFilter}}}}];Object.keys(params).forEach(function(key){var filterValue=params[key];if(window.filterWhitelist.indexOf(key)!==-1){var ranges=filterValue.split(",");var filterObject={range:{}};if(ranges[0]!==""&&ranges[1]!==""){filterObject.range[key]={gte:ranges[0],lte:ranges[1]}}else if(ranges[0]!==""&&ranges[1]===""){filterObject.range[key]={gte:ranges[0]}}else if(ranges[0]===""&&ranges[1]!==""){filterObject.range[key]={lte:ranges[1]}}filterArrayFilters.push(filterObject)}});var queryString=URI.parse(uri.toString()).query;params=URI.parseQuery(queryString);if(typeof params.features!=="undefined"){if(_typeof(params.features)==="object"){for(var i=0;i<params.features.length;i++){var featuresFilter={match:{features:params.features[i]}};filterArrayFilters.push(featuresFilter)}}else{var _featuresFilter={match:{features:params.features}};filterArrayFilters.push(_featuresFilter)}}if(typeof params.brands!=="undefined"){var shouldArray=[];var brandsArray;if(Array.isArray(params.brands)){brandsArray=params.brands}else{brandsArray=[params.brands]}brandsArray.forEach(function(brand){shouldArray.push({match:{brand:brand}})});var brandsFilter={bool:{should:shouldArray}};filterArrayFilters.push(brandsFilter)}var finishedFilterArray=[filterArrayClassifications,filterArrayFilters];finishedFilterArray[1].push({term:{active:true}});return finishedFilterArray}function preselectBoxes(){var params=window.currentState;if(typeof window.currentState.sort!=="undefined"){$("select.customSort").val(window.currentState.sort)}Object.keys(params).forEach(function(key){var filterValue=params[key];if(window.filterWhitelist.indexOf(key)!==-1){if(typeof window.currentState[key]!=="undefined"){var parts=window.currentState[key].split(",");var inputElement=key==="price"?"input":"select";if(typeof parts[0]!=="undefined"&&parts[0]!==""){$("".concat(inputElement,".").concat(key,"From")).val(parts[0])}if(typeof parts[1]!=="undefined"&&parts[1]!==""){$("".concat(inputElement,".").concat(key,"To")).val(parts[1])}}}});var queryString=URI.parse(uri.toString()).query;params=URI.parseQuery(queryString);if(typeof params.features!=="undefined"){if(_typeof(params.features)==="object"){for(var i=0;i<params.features.length;i++){selectCheckboxFilter(params.features[i])}}else{selectCheckboxFilter(params.features)}}if(typeof params.brands!=="undefined"){if(_typeof(params.brands)==="object"){for(var _i3=0;_i3<params.brands.length;_i3++){selectCheckboxFilter(params.brands[_i3])}}else{selectCheckboxFilter(params.brands)}}}function showResetFilterLinks(){var params=window.currentState;Object.keys(params).forEach(function(key){var filterValue=params[key];if(window.filterWhitelist.indexOf(key)!==-1){$(".selectFiltersContainer").find("[data-filter='".concat(key,"']")).show()}else if(key==="brands"){$(".brands-heading").parent().find(".resetFilter").show()}else if(key==="features"){$(".features-heading").parent().find(".resetFilter").show()}})}function locationSuccess(pos){var crd=pos.coords;window.userLat=crd.latitude;window.userLng=crd.longitude;$("#loadingIconContainer").hide();$("#page-selection").show();doSearch(window.tempSortEvent,window.currentState.index);window.tempSortEvent=undefined}function locationError(pos){window.userLat=47.072908;window.userLng=15.439778;$("#loadingIconContainer").hide();$("#page-selection").show();removeSingleParamFromUrl("sort");alert("Leider konnten wir Ihren Standort nicht feststellen. Wir verwenden Graz, Österreich als Standort.");doSearch(window.tempSortEvent,window.currentState.index);window.tempSortEvent=undefined}function getUserLocation(){var options={enableHighAccuracy:true,timeout:5e3,maximumAge:0};$(".searchResults").empty();$(".searchResults").append('<span class="fa fa-refresh spinning"></span> Die Bestimmung Ihres Standorts läuft...');$("#loadingIconContainer").show();$("#page-selection").hide();navigator.geolocation.getCurrentPosition(locationSuccess,locationError,options)}function setSort(customSort){var sortParam={};if(customSort==="price"){sortParam={price:"desc"}}else if(customSort==="priceAsc"){sortParam={price:"asc"}}else if(customSort==="date"){sortParam={created:"desc"}}else if(customSort==="relevance"){sortParam={}}else if(customSort==="location"){sortParam={_geo_distance:{location:"".concat(window.userLat,", ").concat(window.userLng),order:"asc",unit:"km",mode:"min",distance_type:"arc"}}}else{sortParam={}}return sortParam}function getTypeaheadSuggestions(event,searchString){event.preventDefault();client.search({index:"lawi-de-models",ignore:[404],body:{size:0,query:{match_all:{}},suggest:{modelsuggest:{prefix:searchString,completion:{field:"suggest",skip_duplicates:"true",size:20}}}}}).then(function(resp){$("#suggestionList").html("");var suggestions=resp.suggest.modelsuggest[0].options.length>0?resp.suggest.modelsuggest[0].options:[];if(typeof suggestions[0]!=="undefined"&&(suggestions[0].text.toLowerCase()!=searchString.toLowerCase()||suggestions.length>1)){$("#suggenstionListContainer").css({display:"block"});suggestions.forEach(function(suggestion){$("#suggestionList").append("<option value='"+suggestion.text+"'>")})}},function(err){})}function searchInUsedMachines(event){var index="usedmachines";removeSingleParamFromUrl("maincategory");removeSingleParamFromUrl("subcategory");doSearch(event,index)}function searchInClassifieds(event){var index="classifieds";removeSingleParamFromUrl("maincategory");removeSingleParamFromUrl("subcategory");doSearch(event,index)}function doSearch(event){var searchIndex=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"usedmachines,classifieds";event.preventDefault();if($(event.target).attr("class")==="usedmachines"||$(event.target).attr("class")==="classifieds"){removeSingleParamFromUrl("maincategory");removeSingleParamFromUrl("subcategory")}var searchString=$("#searchInput").val();window.searchString=searchString;var searchStringLowercase=searchString.toLowerCase();var currentIndex=uri.search(true).index;if(window.whitelistedIndices.indexOf(currentIndex)!==-1&&currentIndex!==searchIndex){window.initializeCategoryDOMTree=true;resetParams(searchString)}window.currentState=getCurrentStateFromUrl();addSingleParamToUrl("index",searchIndex);window.currentPage=window.currentState.page||1;window.category=window.currentState.category||1;var customSort=window.currentState.sort||"relevance";if(typeof window.currentState.index==="undefined"||window.currentState.index!==searchIndex){window.currentState.index=searchIndex}var filters=buildFiltersFromUrl();initializeDOMForNewSearch();var sortParam=setSort(customSort);var filterArray=buildFilterArray(filters);var didYouMeanConfig={text:searchString,simple_phrase:{phrase:{field:"title.trigram",size:1,gram_size:3,direct_generator:[{field:"title.trigram",suggest_mode:"always",min_word_length:2},{field:"title.reverse",suggest_mode:"always",pre_filter:"reverse",post_filter:"reverse",min_word_length:2}],highlight:{pre_tag:"<em><b>",post_tag:"</b></em>"},collate:{query:{inline:{match:{"{{field_name}}":"{{suggestion}}"}}},params:{field_name:"title"},prune:true}}}};var currentTimestamp=Math.floor(Date.now()/1e3);var numberOfPromotions=5;if(window.currentState.index==="usedmachines,classifieds"){numberOfPromotions=3}var aggregationsConfig={count_all_types:{terms:{field:"_index"}},usedmachines_promotions:{filter:{bool:{should:[{match:{title:searchString}},{match:{type:searchString}},{match:{"categories.german":searchString}},{match:{features:searchString}},{match:{firmname:searchString}},{match:{brand:searchString}}],must:[{range:{hasdiscount:{gte:4}}}]}},aggs:{top_promotion_hits:{top_hits:{sort:[{data_quality:{order:"desc"}},{created:{order:"desc"}},{hasdiscount:{order:"desc"}},{firm_premium_factor:{order:"desc"}}],_source:{includes:["id","title","subtitle","type","brand","description","firmid","md5picsum","picid","youtubeid","cpicture","fpicture","contractorimage","price","classifications","taxname","discount_rate","firm_premium_factor","data_quality","hasdiscount","created","state","ps","hours","width","capacity","volume","year"]},size:8}}}},classified_promotions:{filter:{bool:{should:[{range:{vip_until:{gte:currentTimestamp}}},{range:{top_until:{gte:currentTimestamp}}}]}},aggs:{top_promotion_hits:{top_hits:{sort:[{data_quality:{order:"desc"}},{created:{order:"desc"}},{hasdiscount:{order:"desc"}},{firm_premium_factor:{order:"desc"}}],_source:{includes:["id","title","subtitle","type","brand","description","firmid","md5picsum","picid","youtubeid","cpicture","fpicture","contractorimage","price","classifications","taxname","discount_rate","firm_premium_factor","data_quality","hasdiscount","created","state","ps","hours","width","capacity","volume","year"]},size:3}}}},brands:{terms:{field:"brand.keyword",size:50,min_doc_count:1}},features:{terms:{field:"feature_tokens",size:50,min_doc_count:1}},years:{terms:{field:"year",size:100,min_doc_count:1}},horsePowers:{histogram:{field:"ps",interval:15,min_doc_count:1}},widths:{histogram:{field:"width",interval:30,min_doc_count:1}},volumes:{histogram:{field:"volume",interval:1,min_doc_count:1}},capacities:{histogram:{field:"capacity",interval:250,min_doc_count:1}},classifications:{nested:{path:"classifications"},aggs:{categories:{terms:{field:"classifications.maincategory.keyword"},aggs:{sub_categories:{terms:{field:"classifications.subcategory.keyword"}}}}}}};var sortArray;var indexName="";if(window.currentState.index==="usedmachines"){indexName="lawi-de-usedmachines"}else if(window.currentState.index==="classifieds"){indexName="lawi-de-classifieds"}else if(window.currentState.index==="usedmachines,classifieds"){indexName="lawi-de-usedmachines,lawi-de-classifieds"}sortArray=[sortParam,{_score:"desc"}];var queryObject={};if(searchString===""){queryObject={match_all:{}}}else{queryObject={bool:{must:{multi_match:{query:searchString,type:"cross_fields",fields:["title","title.germantext^5","type","categories.keyword","description","description.germantext^2","features","firmname","country","state","brand"],operator:"and"}},filter:filterArray[1]}}}var searchConfig={index:indexName,ignore:[404],body:{_source:["id","title","subtitle","type","brand","description","firmid","md5picsum","picid","youtubeid","cpicture","fpicture","contractorimage","price","classifications","taxname","discount_rate","firm_premium_factor","data_quality","hasdiscount","created","state","ps","hours","width","capacity","volume","year"],sort:sortArray,size:pageLimit,from:window.currentPage*pageLimit-pageLimit,query:{function_score:{functions:[{exp:{data_quality:{origin:15,scale:3,offset:0,decay:.5}},weight:10},{gauss:{firm_premium_factor:{origin:3,scale:.5,offset:0,decay:.1}},weight:5},{gauss:{created:{scale:"180d",offset:0,decay:.7}},weight:1}],query:queryObject,boost_mode:"sum"}},suggest:didYouMeanConfig,aggs:aggregationsConfig,post_filter:{bool:{filter:filterArray[0]}}}};client.search(searchConfig).then(function(resp){if(window.location.href.indexOf("dev.landwirt.com")!==-1||window.location.href.indexOf("dev73.landwirt.com")!==-1){console.log(resp)}var hits=resp.hits.hits;var categoryHits=resp.aggregations.count_all_types.buckets;var topPromotionsUsedMachines=resp.aggregations.usedmachines_promotions.doc_count>0?resp.aggregations.usedmachines_promotions.top_promotion_hits.hits.hits:[];var topPromotionsClassifieds=resp.aggregations.classified_promotions.doc_count>0?resp.aggregations.classified_promotions.top_promotion_hits.hits.hits:[];var usedMachinesPromotionIds=topPromotionsUsedMachines.map(function(o){return o._id});var classifiedsPromotionIds=topPromotionsClassifieds.map(function(o){return o._id});var topVideos=[];var exactModel=[];var total=resp.hits.total.value;var contents=[];var renderedSearchResults=[];var topScore=0;var classifications=[];var brands=[];var features=[];var years=[];var horsePowers=[];var widths=[];var volumes=[];var capacities=[];initializePagination(total);if(Object.keys(resp.aggregations).length>0){classifications=resp.aggregations.classifications.categories.buckets.length>0?resp.aggregations.classifications.categories.buckets:[];brands=resp.aggregations.brands.buckets.length>0?resp.aggregations.brands.buckets:[];features=resp.aggregations.features.buckets.length>0?resp.aggregations.features.buckets:[];years=resp.aggregations.years.buckets.length>0?resp.aggregations.years.buckets:[];horsePowers=resp.aggregations.horsePowers.buckets.length>0?resp.aggregations.horsePowers.buckets:[];widths=resp.aggregations.widths.buckets.length>0?resp.aggregations.widths.buckets:[];volumes=resp.aggregations.volumes.buckets.length>0?resp.aggregations.volumes.buckets:[];capacities=resp.aggregations.capacities.buckets.length>0?resp.aggregations.capacities.buckets:[]}if(total<=5){handleDidYouMean(resp.suggest)}$("#mobile-show-results").text("".concat(total," Ergebnisse anzeigen"));if(window.currentPage==="1"||typeof window.currentState.page==="undefined"){for(var i=0;i<topPromotionsUsedMachines.length;i++){var hit=topPromotionsUsedMachines[i];var index=hit._index;var type="";hit=hit._source;var properties={capacity:hit.capacity,hours:hit.hours,ps:hit.ps,volume:hit.volume,width:hit.width,year:hit.year};var url="#";var imageUrl="";if(index.indexOf("usedmachines")!==-1){type="usedmachines";$(".".concat(type)).text("Gebrauchtmaschinen").css({display:"block"});url="".concat(domain,"gebrauchte,").concat(hit.id,",").concat(makeUrl(hit.title),".html");imageUrl="".concat(imageUrlBasePath).concat(hit.firmid,"-").concat(hit.md5picsum,"-").concat(hit.id,"-").concat(hit.picid,".jpg")}else if(index.indexOf("classifieds")!==-1){type="classifieds";$(".".concat(type)).text("Kleinanzeigen").css({display:"block"});url="".concat(classifiedBaseUrl).concat(hit.id);imageUrl="".concat(eZImageUrlBasePath).concat(hit.cpicture)}contents.push({type:type,id:hit.id,created:hit.created,title:hit.title,description:hit.description,imageUrl:imageUrl,url:url,price:hit.price,taxname:hit.taxname,discount_rate:hit.discount_rate,firm_premium_factor:hit.firm_premium_factor,firmid:hit.firmid,hasdiscount:hit.hasdiscount,state:hit.state,dataQuality:hit.data_quality,properties:properties})}for(var i=0;i<topPromotionsClassifieds.length;i++){var _hit=topPromotionsClassifieds[i];var _index=_hit._index;var _type="";_hit=_hit._source;var _properties={capacity:_hit.capacity,hours:_hit.hours,ps:_hit.ps,volume:_hit.volume,width:_hit.width,year:_hit.year};var _url="#";var _imageUrl="";if(_index.indexOf("usedmachines")!==-1){_type="usedmachines";$(".".concat(_type)).text("Gebrauchtmaschinen").css({display:"block"});_url="".concat(domain,"gebrauchte,").concat(_hit.id,",").concat(makeUrl(_hit.title),".html");_imageUrl="".concat(imageUrlBasePath).concat(_hit.firmid,"-").concat(_hit.md5picsum,"-").concat(_hit.id,"-").concat(_hit.picid,".jpg")}else if(_index.indexOf("classifieds")!==-1){_type="classifieds";$(".".concat(_type)).text("Kleinanzeigen").css({display:"block"});_url="".concat(classifiedBaseUrl).concat(_hit.id);_imageUrl="".concat(eZImageUrlBasePath).concat(_hit.cpicture)}contents.push({type:_type,id:_hit.id,created:_hit.created,title:_hit.title,description:_hit.description,imageUrl:_imageUrl,url:_url,price:_hit.price,taxname:_hit.taxname,discount_rate:_hit.discount_rate,firm_premium_factor:_hit.firm_premium_factor,hasdiscount:_hit.hasdiscount,state:_hit.state,dataQuality:_hit.data_quality,properties:_properties})}}for(var i=0;i<hits.length;i++){var _hit2=hits[i];var _index2=_hit2._index;var currentId=_hit2._id;var _type2="";_hit2=_hit2._source;var _properties2={capacity:_hit2.capacity,hours:_hit2.hours,ps:_hit2.ps,volume:_hit2.volume,width:_hit2.width,year:_hit2.year};var _url2="#";var _imageUrl2="";if(usedMachinesPromotionIds.indexOf(currentId)===-1&&classifiedsPromotionIds.indexOf(currentId)===-1){if(_index2.indexOf("usedmachines")!==-1){_type2="usedmachines";$(".".concat(_type2)).text("Gebrauchtmaschinen").css({display:"block"});_url2="".concat(domain,"gebrauchte,").concat(_hit2.id,",").concat(makeUrl(_hit2.title),".html");_imageUrl2="".concat(imageUrlBasePath).concat(_hit2.firmid,"-").concat(_hit2.md5picsum,"-").concat(_hit2.id,"-").concat(_hit2.picid,".jpg")}else if(_index2.indexOf("classifieds")!==-1){_type2="classifieds";$(".".concat(_type2)).text("Kleinanzeigen").css({display:"block"});_url2="".concat(classifiedBaseUrl).concat(_hit2.id);_imageUrl2="".concat(eZImageUrlBasePath).concat(_hit2.cpicture)}contents.push({type:_type2,id:_hit2.id,created:_hit2.created,title:_hit2.title,subtitle:_hit2.subtitle,description:_hit2.description,imageUrl:_imageUrl2,url:_url2,price:_hit2.price,taxname:_hit2.taxname,discount_rate:_hit2.discount_rate,firm_premium_factor:_hit2.firm_premium_factor,firmid:_hit2.firmid,hasdiscount:_hit2.hasdiscount,state:_hit2.state,dataQuality:_hit2.data_quality,properties:_properties2})}}$("#loadingIconContainer").addClass("hidden");$("#page-selection").removeClass("hidden");renderedSearchResults=contents.map(searchResultTemplate).join("");var otherCategory=window.currentState.index==="usedmachines"?"Kleinanzeigen":"Gebrauchtmaschinen";var suggestedIndex=window.currentState.index==="usedmachines"?"classifieds":"usedmachines";var suggestedUrl=window.location.pathname+"?q=".concat(window.currentState.q,"&index=").concat(suggestedIndex);var currentHeading=window.currentState.index==="usedmachines"?"Treffer in Gebrauchtmaschinen":"Treffer in Kleinanzeigen";$("#noResults").text("");if(hits.length===0){$("#noResults").append('Leider keine Suchergebnisse.<br>Versuchen Sie allgemeiner zu suchen, oder <b><a href="#" onclick="resetParams(searchString)" style="text-decoration: underline;">setzen Sie die Filter zurück</a>.</b>').css(_defineProperty({display:"block",textAlign:"center",lineHeight:"2.5rem",marginBottom:"7rem"},"marginBottom","7rem"));$(".sidenavContainer").css({display:"none"});$("#results").css({display:"none"});$(".mobile-filter-container").css({display:"none"});$("#resultHeading").text("")}else{$("#noResults").text("");$("#noResults").css({display:"none"});$("#results").css({display:"block"});$("#resultHeading").text(currentHeading);addAggregationsToDOM(brands,features,classifications,years,horsePowers,widths,volumes,capacities,categoryHits);if(document.body.clientWidth>window.mobileBreakpoint){$(".sidenavContainer").css({opacity:100,display:"block"})}else{$(".mobile-filter-container").css({display:"block"})}if(document.body.clientWidth>=window.mobileBreakpoint){$(".customSort").css({display:"block"})}else{$(".sidenavContainer").css({display:"none"});window.scrollTo(0,0)}preselectBoxes();showResetFilterLinks();$(".searchResults").html(renderedSearchResults).css({textAlign:"left",lineHeight:"1.7rem"});$(".searchResults .gmmtreffer:eq(1)").after("<div id='snhb-listing_top_leaderboard-atf-0'></div>");$(".searchResults .gmmtreffer:eq(7)").after("<div id='snhb-listing_bottom_leaderboard-btf-0'></div>")}},function(err){var nextUrl=window.location.pathname+"?q=".concat(window.currentState.q,"&index=").concat(window.currentState.index);$("#loadingIconContainer").hide();$(".searchResults").append('Ein unbekannter Fehler ist aufgetreten. Bitte klicken Sie <b><a href="'.concat(nextUrl,'" style="text-decoration: underline;">hier</a></b> um fortzufahren.'))})}$(document).ready(function(){window.currentState=getCurrentStateFromUrl();$("#search").on("submit",function(event){var formData=$(this).serializeArray();var searchTerm=formData[0].value;var searchTermUrl=uri.search(true).q;var filters=buildFiltersFromUrl();if(searchTerm!==searchTermUrl){window.initializeCategoryDOMTree=true;resetParams(searchTerm)}if(window.location.href.indexOf("search")!==-1){addSingleParamToUrl("q",searchTerm);$("#searchInput").blur();doSearch(event,window.currentState.index)}else{var searchUrl;var hostname=window.location.hostname;if(hostname.indexOf("extdev")!==-1){searchUrl=window.location.protocol+"//"+hostname+":"+window.location.port+"/search.html?q="+searchTerm}else{searchUrl=window.location.protocol+"//"+hostname+"/search.html?q="+searchTerm}window.location.href=searchUrl;return false}});if($("ul.searchResults").length>0){window.addEventListener("popstate",function(e){window.location.reload(false)},false)}$("#searchInput").on("input",function(event){var currentSearchInput=this.value.toLowerCase();if(currentSearchInput.length>=3){getTypeaheadSuggestions(event,currentSearchInput)}});$(".mobile-filter-container .customSort").on("change",function(event){addSingleParamToUrl("sort",this.value);addSingleParamToUrl("page",1);window.initializeCategoryDOMTree=true;if(this.value==="location"){window.tempSortEvent=event;getUserLocation(event)}else{doSearch(event,window.currentState.index)}});$(".customSort").on("change",function(event){addSingleParamToUrl("sort",this.value);addSingleParamToUrl("page",1);window.initializeCategoryDOMTree=true;if(this.value==="location"){window.tempSortEvent=event;getUserLocation(event)}else{doSearch(event,window.currentState.index)}});$(".brands-filter").on("change",".brand-item",function(event){if(this.checked){uri.addSearch("brands",event.target.dataset.filterbox)}else{uri.removeSearch("brands",event.target.dataset.filterbox)}addSingleParamToUrl("page",1);window.initializeCategoryDOMTree=true;doSearch(event,window.currentState.index)});$(".features-filter").on("change",".feature-item",function(event){if(this.checked){uri.addSearch("features",event.target.dataset.filterbox)}else{uri.removeSearch("features",event.target.dataset.filterbox)}addSingleParamToUrl("page",1);window.initializeCategoryDOMTree=true;doSearch(event,window.currentState.index)});$(".selectFiltersContainer select").on("change",function(event){var regex=/(.*)(From)|(.*)(To)/;var selectedBox=this.className.match(regex);var property=selectedBox[1]||selectedBox[3];var rangeDetail=selectedBox[2]||selectedBox[4];addRangeParamsToUrl(rangeDetail,property,this.value)});$("input.priceFrom, input.priceTo").on("blur",function(event){var regex=/From|To/;var value=parseInt(this.value.trim(),10);var selectedBox=this.className.match(regex);var property="price";var rangeDetail=selectedBox[0];var currentFromValue="";var currentToValue="";if(isNaN(value)){value=""}if(document.body.clientWidth<=window.mobileBreakpoint){currentFromValue=$("#mobileSidenavContainer input.priceFrom").val();currentToValue=$("#mobileSidenavContainer input.priceTo").val()}else{currentFromValue=$(".sidenavContainer input.priceFrom").val();currentToValue=$(".sidenavContainer input.priceTo").val()}if(currentFromValue===""&&currentToValue===""){removeSingleParamFromUrl("price")}else{addRangeParamsToUrl(rangeDetail,property,value)}});$(".resetFilter").on("click",function(e){e.preventDefault();var property=$(this).data("filter");if(property==="price"){$("input.priceFrom, input.priceTo").val("")}removeSingleParamFromUrl(property);window.initializeCategoryDOMTree=true;doSearch(event,window.currentState.index)});if(typeof window.currentState.q!=="undefined"&&window.location.href.indexOf("search")!==-1){window.initializeCategoryDOMTree=true;$("#searchInput").val(window.currentState.q);$("#search").submit()}$(".mobile-filter-container .filter").on("click",function(){$("#mobileSidenavContainer").css({display:"block",visibility:"visible"});$("body").addClass("noscroll")});$("#mobile-show-results, #close-mobile-filters").on("click",function(){$("#mobileSidenavContainer").css({display:"none",visibility:"hidden"});$("body").removeClass("noscroll")});$("#reset-mobile-filters").on("click",function(){resetParams(searchString);doSearch(event,window.currentState.index);$("#mobileSidenavContainer").css({display:"none",visibility:"hidden"});$("body").removeClass("noscroll")})});var resizeTimeout;$(window).resize(function(){if(!!resizeTimeout){clearTimeout(resizeTimeout)}resizeTimeout=setTimeout(function(){if(document.body.clientWidth<=window.mobileBreakpoint){$(".sidenavContainer").css({display:"none"});$(".customSort").css({display:"none"});$(".mobile.customSort").css({display:"block"});$(".mobile-filter-container").css({display:"block"})}else{$(".sidenavContainer").css({display:"block"});$(".customSort").css({display:"block"});$(".mobile.customSort").css({display:"none"});$(".mobile-filter-container").css({display:"none"})}},200)});